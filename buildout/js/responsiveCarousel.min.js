/*!
 * responsiveCarousel
 * A responsive carousel that works in desktop browsers, ipad, iphone, and even
 * most Androids.  It uses css3 animations with a jquery animation fallback for
 * greater speed.  The code was optimized to minimize page reflows to further
 * enhance the overall speed..
 *
 * This is a jQuery UI Widget
 *
 * @version 1.5.2
 * @releaseDate 3/5/2013
 * @author Matthew Toledo
 * @url https://github.com/mrbinky3000/responsive_carousel
 * @requires jQuery, jQuery UI (only the Core and Widget Factory)
 * @requires hammer.js (for touch and drag events, mouse drag too)
 * @recommended Modernizr (used to test for css3 transitions and touch screens)
 */
(function(d,k,m){var p=0;d.widget("ri.responsiveCarousel",{options:{arrowLeft:".arrow-left span",arrowRight:".arrow-right span",mask:".slider-mask",target:"ul",unitElement:"li",unitWidth:"inherit",responsiveUnitSize:null,onRedraw:null,ondragstart:null,ondragend:null,dragEvents:!1,easing:"linear",speed:400,slideSpeed:2500,step:-1,responsiveStep:null,onShift:null,cssAnimations:Modernizr.csstransitions,nudgeThreshold:10,infinite:!1,delta:1},_getPrefix:function(a){for(var c=["Moz","Webkit","Khtml","0",
"ms"],b=m.createElement("div"),f=a.charAt(0).toUpperCase()+a.slice(1),d="",g=c.length;-1<g;)void 0!==b.style[c[g]+f]&&(d=c[g]),g-=1;return d=b.style[a]?a.toLowerCase():"-"+d.toLowerCase()+"-"},_round:function(a){if("compute"===this.options.unitWidth||"inherit"===this.options.unitWidth||"integer"===this.options.unitWidth)a=Math.round(a/this.internal.unitWidth)*this.internal.unitWidth;return a},_animate:function(a,c,b,f){var e=this.options,g=this.internal,h=this._round(Math.floor(a.position().left)),
j=c.left,q=h+j;!0===e.infinite&&void 0!==j&&(j<h?(j=-1*g.unitWidth*(g.numUnits-g.numVisibleUnits),h===j&&(a.css({transition:"",left:0}),c.left=-g.unitWidth)):j>h&&0===h&&(j=-1*Math.floor(a.find(".clone:first").position().left),a.css({transition:"",left:j}),c.left=j+q));k.setTimeout(function(){if(e.cssAnimations){var g=d.extend({transition:"left "+b/1E3+"s "+e.easing},c);a.css(g);k.setTimeout(function(){a.css({transition:""});d.isFunction(f)&&f()},b)}else a.animate(c,b,function(){d.isFunction(f)&&
f()})},1)},_setTargetWidth:function(){var a=this.internal,c=this.options;d(this.element);d(c.target);a.numUnits=d(c.unitElement).length;"individual"===c.unitWidth?(a.targetWidth=0,d(c.unitElement).each(function(){var b=d(this),c;b.css("width","");c=Math.ceil(b.width())+1;b.width(c);a.targetWidth+=c;d(this).data("responsiveCarousel",{width:c,top:Math.floor(b.position().top),right:Math.floor(b.position().left)+b.width(),bottom:Math.floor(b.position().top)+b.height(),left:Math.floor(b.position().left)})})):
a.targetWidth=a.numUnits*a.unitWidth;d(c.target).width(a.targetWidth);a.targetHeight=d(c.target).height();a.maskWidth=d(c.mask).width();a.maskHeight=d(c.mask).height()},_setArrowVisibility:function(){var a=this.options,c=this.internal,b=d(a.target),f=d(a.arrowLeft),e=d(a.arrowRight),g=c.maskWidth,b=this._round(Math.floor(b.position().left)),h=c.targetWidth+b;e.length&&(!0!==a.infinite&&h<=g?(e.addClass("disabled"),!0===c.isArrowBeingClicked&&this._clearInterval(),c.arrowRightVisible=c.isArrowBeingClicked=
!1):!1===c.arrowRightVisible&&(e.removeClass("disabled"),c.arrowRightVisible=!0));f.length&&(!0!==a.infinite&&0<=b?(f.addClass("disabled"),!0===c.isArrowBeingClicked&&this._clearInterval(),c.arrowLeftVisible=c.isArrowBeingClicked=!1):!1===c.arrowLeftVisible&&(f.removeClass("disabled"),c.arrowLeftVisible=!0));if("individual"===a.unitWidth)for(e=0;e<c.numUnits;e++){if(f=d(a.unitElement).eq(e),Math.abs(b)>=f.data("responsiveCarousel").left&&Math.abs(b)<f.data("responsiveCarousel").right){c.currentSlide=
f.data("slide");break}}else c.currentSlide=d(a.unitElement).eq([Math.abs(b/c.unitWidth)]).data("slide");if(d.isFunction(a.onShift)){if(e=c.currentSlide,"number"===typeof e)a.onShift(e)}else if(null!==a.onShift)throw Error("The onShift option must be a function or null if not in use.");},_clearInterval:function(){var a=this.internal,c=this.options,b=d(c.target);"number"===typeof a.timer&&(a.isArrowBeingClicked=!1,k.clearInterval(a.timer));!1===a.busy&&(a.busy=!0,this._animate(b,{left:this.computeAdjust(b,
"clearInterval")},c.speed,function(){a.busy=!1}))},_doArrowBeingClicked:function(a){var c=this,b=this.internal,f=this.options,e=d(f.target),g=Math.floor(e.position().left);if(!0!==b.busy){if("individual"===f.unitWidth)if("right"===a)a=d(f.unitElement).eq(b.currentSlide+1).length?-1*d(f.unitElement).eq(b.currentSlide+1).data("responsiveCarousel").left:g-(b.nudgeThreshold?b.nudgeThreshold:20);else if("left"===a)a=d(f.unitElement).eq(b.currentSlide-1).length?-1*d(f.unitElement).eq(b.currentSlide-1).data("responsiveCarousel").left:
g+(b.nudgeThreshold?b.nudgeThreshold:20);else throw Error("unknown direction");else if("left"===a)a=g+b.unitWidth;else if("right"===a)a=g-b.unitWidth;else throw Error("unknown direction");a=Math.floor(a);b.busy=!0;this._animate(e,{left:a},f.speed,function(){c._setArrowVisibility("_doArrowBeingClicked");b.busy=!1})}},_setArrowEvents:function(){var a=this,c=this.options,b=this.internal,f=d(c.arrowLeft),e=d(c.arrowRight),g="",h="";f.on("click"+this.instanceId,function(b){b.preventDefault()});e.on("click"+
this.instanceId,function(b){b.preventDefault()});!0===c.dragEvents?(g="mousedown"+this.instanceId+" touchstart"+this.instanceId+" gesturestart"+this.instanceId+" gesturechange"+this.instanceId,h="mouseup"+this.instanceId+" mouseout"+this.instanceId+" mouseleave"+this.instanceId+" touchend"+this.instanceId+" touchleave"+this.instanceId+" gestureend"+this.instanceId):(g="mousedown"+this.instanceId,h="mouseup"+this.instanceId+" mouseout"+this.instanceId+" mouseleave"+this.instanceId);f.on(g,function(c){c.preventDefault();
c.stopPropagation();!1===b.busy&&!f.hasClass("disabled")&&(b.isArrowBeingClicked=b.firstMouseClick=!0,b.timer=k.setInterval(function(){a._doArrowBeingClicked("left")},10),b.slideTimer&&(k.clearInterval(b.slideTimer),b.slideShowActive=!1))});e.on(g,function(c){c.preventDefault();c.stopPropagation();!1===b.busy&&!e.hasClass("disabled")&&(b.isArrowBeingClicked=b.firstMouseClick=!0,b.timer=k.setInterval(function(){a._doArrowBeingClicked("right")},10),b.slideTimer&&(k.clearInterval(b.slideTimer),b.slideShowActive=
!1))});d.each([f,e],function(){d(this).on(h,function(){!0===b.isArrowBeingClicked&&a._clearInterval()})});d(k).on("scroll"+this.instanceId+" resize"+this.instanceId+" onorientationchange"+this.instanceId,function(){a._clearInterval()})},_setUnitWidth:function(){var a,c,b=this,f=this.internal,e=this.options,g=d(e.target),h=d(this.element),j=d(e.unitElement+":not(.clone)"),q=j.eq(0),l,n=function(){f.unitWidth=q.width()},r=function(){var b=d(e.mask).width();c=e.responsiveUnitSize(h,f,e);if("number"!==
typeof c||1>c)throw Error("The responsiveUnitSize callback must return a whole number greater than 0");a=b/c;a=Math.floor(a);d(e.unitElement).css("width",a);!0===e.infinite&&(0<c&&c!==f.numVisibleUnits)&&(f.numVisibleUnits=c,g.find(".clone").remove(),j.slice(0,f.numVisibleUnits).clone(!0).addClass("clone").appendTo(g));f.unitWidth=a;f.numVisibleUnits=c};if("inherit"===e.unitWidth)n(),g.find("img").one("load"+b.instanceId,function(){n();b._setTargetWidth("inherit");b._setArrowVisibility("_setUnitWidth inherit imageload");
if(d.isFunction(e.onRedraw))e.onRedraw(h,f,e)});else if("individual"===e.unitWidth){if(d.isFunction(e.onRedraw))e.onRedraw(h,f,e);g.find("img").one("load"+b.instanceId,function(){b._setTargetWidth("individual");b._setArrowVisibility("_setUnitWidth individual imageload");if(d.isFunction(e.onRedraw))e.onRedraw(h,f,e)});d(k).on("resize"+b.instanceId,function(){clearTimeout(l);l=setTimeout(function(){var a;b._setTargetWidth("individual (window resize)");a=-1*d(e.unitElement).eq(f.currentSlide).data("responsiveCarousel").left;
g.css({left:a});b._setArrowVisibility("_setUnitWidth individual resize");if(d.isFunction(e.onRedraw))e.onRedraw(h,f,e)},400)})}else if("compute"===e.unitWidth){n();d.isFunction(e.responsiveUnitSize)&&(r(),n());if(d.isFunction(e.onRedraw))e.onRedraw(h,f,e);g.find("img").each(function(){d(this).one("load"+b.instanceId,function(){if(!1===g.is(":hidden")&&(d.isFunction(e.responsiveUnitSize)&&r(),n(),b._setTargetWidth("compute (image load) "+b.instanceId),b._setArrowVisibility("_setUnitWidth compute imageload"),
d.isFunction(e.onRedraw)))e.onRedraw(h,f,e)})});d(k).on("resize"+b.instanceId,function(){clearTimeout(l);!1===g.is(":hidden")&&(l=setTimeout(function(){var a;d.isFunction(e.responsiveUnitSize)&&(r(),n());n();b._setTargetWidth("compute (window resize) "+b.instanceId);a=-1*f.currentSlide*f.unitWidth;a<-1*f.maskWidth&&(a=f.maskWidth-f.targetWidth);g.css({left:a});b._setArrowVisibility("_setUnitWidth compute resize");if(d.isFunction(e.onRedraw))e.onRedraw(h,f,e)},400))})}else f.unitWidth=e.unitWidth},
_dragEvents:function(){var a=this,c=this.options,b=this.internal,f=d(c.target),e=d(c.mask),g=new Hammer(e.get(0),{prevent_default:!1,css_hacks:!0,drag:!0,drag_vertical:!1,drag_horizontal:!0,drag_min_distance:10,swipe:!1,transform:!1,tap:!1,tap_double:!1,hold:!1}),h={},j;b.touchObject=g;g.ondragstart=function(){a.stopSlideShow();if(!0===b.isArrowBeingClicked||!0===b.busy)return{};b.busy=!0;h={top:parseInt(f.css("top"),10),left:parseInt(f.css("left"),10)};h.time=(new Date).getTime();b.scrollStart=h;
if(d.isFunction(c.ondragstart))c.ondragstart(c,b)};g.ondrag=function(a){j&&clearTimeout(j);j=setTimeout(function(){if(!0===b.busy)g.ondragend()},400);if(!0!==b.isArrowBeingClicked){var d=c.delta,e,k,m=-1*b.unitWidth*(b.numUnits-b.numVisibleUnits);if("up"===a.direction||"left"===a.direction)a.distance*=-1;e=h.left+a.distance*d;k=Math.abs(b.scrollStart.left-e);b.nudgeDirection=k>c.nudgeThreshold&&k<b.unitWidth/2?"up"===a.direction||"left"===a.direction?"left":"right":k<=c.nudgeThreshold?"abort":null;
!0===c.infinite&&(e<=m&&(e=0+a.distance*d,b.scrollStart.left=0),0<=e&&(e=m+a.distance*d,b.scrollStart.left=m));b.left=e;f.css("left",e)}};g.ondragend=function(){j&&k.clearTimeout(j);f.stop(!0,!1);a._animate(f,{left:a.computeAdjust(f,"dragend")},c.speed,function(){a._setArrowVisibility("ondragend");b.busy=!1;if(d.isFunction(c.ondragend))c.ondragend(c,b)})}},_create:function(){p+=1;var a=this.options,c=d(this.element),b=d(a.target);this.instanceId=".carousel_"+p.toString(10);this.internal={busy:!1,
currentSlide:0,left:0,targetWidth:0,targetHeight:0,maskWidth:0,maskHeight:0,unitWidth:0,targetBackupCopy:null,isArrowBeingClicked:!1,arrowLeftVisible:!0,arrowRightVisible:!0,targetLeft:0,timer:null,firstMouseClick:!1,prefix:null,slideShowActive:!1,slideTimer:null,slideBumped:!1,nudgeDirection:null,infinite:!1,numUnits:null,numVisibleUnits:null,scrollStart:0,touchObject:null};this.internal.targetBackupCopy=this.element;this.options.cssAnimations&&(this.internal.prefix=this._getPrefix("transition"));
b.css({position:"relative",left:0});d(a.unitElement).each(function(a){d(this).attr({"data-slide":a})});!0===a.dragEvents&&this._dragEvents();this._setArrowEvents();b.not(":hidden")&&(this._setUnitWidth(),this._setTargetWidth("first load"),this._setArrowVisibility("_create"));if(d.isFunction(a.onRedraw))a.onRedraw(c,this.internal,a);!0!==d("body").data("iosfix"+this.instanceId)&&(d(m).on("scroll"+this.instanceId,function(){d(m).trigger("touchend")}),d("body").data("iosfix",!0));d(a.target).find("img").trigger("appear")},
redraw:function(){var a=this.internal,c=this.options,b=d(this.element);if(d(c.target).not(":hidden")&&(void 0===this.unitWidth&&this._setUnitWidth(),this._setTargetWidth("_redraw (manually called) "+this.instanceId),this._setArrowVisibility("forced redraw"),d.isFunction(this.options.onRedraw)))this.options.onRedraw(b,a,c)},getCurrentSlide:function(){return this.internal.currentSlide},goToSlide:function(a,c){var b=this,f=this.internal,e=this.options,g=d(e.target),h;c=void 0!==c?c:!0;g.not(":hidden")&&
(void 0===this.unitWidth&&this._setUnitWidth(),h="individual"===e.unitWidth?d(e.unitElement).eq(a).data("responsiveCarousel").left:-1*a*f.unitWidth,f.busy=!0,!0===c?this._animate(g,{left:h},e.speed,function(){f.busy=!1;b._setArrowVisibility("goto slide")}):g.css("left",h))},toggleSlideShow:function(){!1===this.internal.slideShowActive?this.startSlideShow():this.stopSlideShow()},_step:function(a){var c=this,b=this.internal,f=this.options,e=d(f.target),g=b.maskWidth,h=this._round(Math.floor(e.position().left)),
j=h+a*b.unitWidth,k=h+b.targetWidth;a=k+a*b.unitWidth;var l=j;!1===b.slideBumped?!1===f.infinite&&(a<=g&&(l=j+g-a,b.slideBumped="left"),0<=j&&(b.slideBumped="right",l=0)):("left"===b.slideBumped&&(l=0),"right"===b.slideBumped&&(l=h+g-k),b.slideBumped=!1);b.busy=!0;this._animate(e,{left:l},f.speed,function(){b.busy=!1;c._setArrowVisibility("_step")})},startSlideShow:function(){var a=this,c=this.internal,b=this.options;!1===c.slideShowActive&&(c.slideShowActive=!0,c.slideTimer=k.setInterval(function(){a._step(b.step)},
b.slideSpeed))},stopSlideShow:function(){var a=this.internal;!0===a.slideShowActive&&(a.slideShowActive=!1,k.clearInterval(a.slideTimer))},_destroy:function(){var a=d(this.options.target),c=d(this.options.mask);d(this.options.arrowLeft).unbind(this.instanceId);d(this.options.arrowRight).unbind(this.instanceId);a.find("img").unbind(this.instanceId);null!==this.internal.touchObject&&this.internal.touchObject.destroy();d(m).unbind(this.instanceId);d("body").removeData("iosfix"+this.instanceId);c.css({"-webkit-user-select":"",
"-webkit-user-drag":"","-webkit-tap-highlight-color":""});k.setTimeout(function(){a.css({position:"",left:"",width:""})},1)},computeAdjust:function(a){var c=this.internal,b=this.options;a=Math.floor(a.position().left);var f,e=c.maskWidth,g;f=c.nudgeDirection;var h=c.unitWidth,j=!1;null!==f&&("left"===f&&(g=a-h),"right"===f&&(g=a+h),"abort"===f&&(g=c.scrollStart.left),a=g,c.nudgeDirection=null);f=a+c.targetWidth;f<e&&(a=g=a+e-f,j=!0);0<a&&(a=g=0);if("individual"===b.unitWidth)for(h=0;h<c.numUnits;h++)if(f=
d(b.unitElement).eq(h),!0==j)c.targetWidth>e&&(g=c.maskWidth-c.targetWidth);else{if(Math.abs(a)>=f.data("responsiveCarousel").left&&Math.abs(a)<=f.data("responsiveCarousel").right){g=-1*f.data("responsiveCarousel").left;break}}else g=this._round(a);return g}})})(jQuery,window,document);
